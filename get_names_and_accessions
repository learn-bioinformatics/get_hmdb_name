if [[ ! -f "names_to_ID.hmdb_metabolites.txt" ]]; then

    if [[ ! -f "hmdb_metabolites.xml" ]]; then
        wget https://hmdb.ca/system/downloads/current/hmdb_metabolites.zip
        unzip hmdb_metabolites.zip
    fi



    grep -P '^  <name>' hmdb_metabolites.xml | sed 's/  <name>//' | sed 's/<\/name>//'  > names.txt
    grep -P '^  <accession>' hmdb_metabolites.xml | sed 's/  <accession>//' | sed 's/<\/accession>//'  > accessions.txt
    paste names.txt accessions.txt | sort > names_to_ID.hmdb_metabolites.txt
    rm names.txt
    rm accessions.txt

fi

awk 'BEGIN{FS="\t"; OFS="\t"} {print NR,$0}' list.txt  | sort -k2 > numbered.list.txt
sort list.txt  > sorted.list.txt

join -a 2 -t$'\t' names_to_ID.hmdb_metabolites.txt sorted.list.txt > name_sorted.combined.list.txt

join -1 2 -2 1 -t$'\t' numbered.list.txt name_sorted.combined.list.txt | sort -t$'\t' -k2 > original_order.list.txt

awk 'BEGIN{FS="\t"; OFS="\t"} {print $1,$3}' original_order.list.txt > clean_original_order.list.txt
